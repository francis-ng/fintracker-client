{"version":3,"sources":["utils/authConnector.js","utils/authUtils.js","components/AuthScreen.js","utils/ledgerConnector.js","workers/syncWorker.js","components/LedgerList.js","components/LedgerDetails.js","App.js","workers/service-worker.js","serviceWorker.js","index.js"],"names":["getServerUrl","isReachable","fetch","this","method","mode","then","resp","catch","err","login","username","password","url","headers","body","JSON","stringify","UserName","Password","response","ok","json","data","success","token","register","getToken","localStorage","getItem","saveToken","setItem","AuthSceen","props","showLogin","bind","showRegister","handleInputChange","handleLogin","handleRegister","verifyPassword","loggedIn","completionCallback","state","showSpinner","regSuccess","regFailed","loginFailed","LoginUserName","LoginPassword","RegUserName","RegPassword","RegPasswordVerify","setState","event","value","target","name","preventDefault","authConnector","result","authUtils","onSubmit","Stack","tokens","childrenGap","horizontalAlign","MessageBar","messageBarType","MessageBarType","isMultiline","error","TextField","label","onChange","required","type","horizontal","verticalAlign","PrimaryButton","text","Spinner","size","SpinnerSize","small","Link","onClick","onGetErrorMessage","Component","db","listLedgers","getUrl","authHeader","Headers","status","getLedger","year","month","addLedger","ledger","addUrl","updateLedger","updateUrl","Id","deleteLedger","deleteUrl","LedgerList","updateLedgerList","showFixed","onChangeHandler","renderCell","showingFixed","selectionHandler","selectHandler","loginHandler","months","ledgers","commandItems","key","iconProps","iconName","farItems","ariaLabel","iconOnly","dropdownOptions","displayedLedgers","years","i","length","indexOf","Year","push","parseInt","sort","a","b","options","ledgerConnector","filter","item","Type","sortLedgers","configureDropdown","dataset","Month","date","Date","latestYear","getFullYear","latestMonth","getMonth","filterByYear","index","className","data-year","data-month","Text","data-is-scrollable","Dropdown","placeholder","CommandBar","items","medium","List","onRenderCell","LedgerDetails","save","addItem","handleTabClick","renderItemColumn","populateFixedItems","backToList","returnHandler","parameters","selection","newLedger","displayprops","columns","fieldName","isPadded","stackItemStyles","root","alignItems","justifyContent","display","Debits","DebitTotal","Credits","CreditTotal","selectedTab","saveSuccess","saveFailed","dataLoaded","getLedgerDetails","prevProps","console","log","prevState","concat","Label","Amount","total","current","itemKey","map","el","reduce","calculateTotal","column","data-index","Pivot","selectedKey","onLinkClick","styles","link","width","linkIsSelected","PivotItem","headerText","ShimmeredDetailsList","selectionMode","SelectionMode","none","layoutMode","DetailsListLayoutMode","justified","isHeaderVisible","enableShimmer","onRenderItemColumn","padding","Item","grow","App","title","showLedgerList","showLedger","selectedLedger","origin","dir","variant","CSSTransition","in","timeout","classNames","mountOnEnter","unmountOnExit","AuthScreen","dbRequest","window","indexedDB","open","onsuccess","onerror","onupgradeneeded","objectStore","createObjectStore","autoIncrement","createIndex","unique","serverUrl","isOnline","handleConnection","navigator","onLine","online","addEventListener","setInterval","transaction","getCursor","e","cursor","serverUpd","parse","UpdatedAt","postMessage","delete","continue","onmessage","add","appShellFiles","syncWorker","waitUntil","caches","cache","addAll","respondWith","request","put","clone","match","r","Response","keys","keyList","Promise","all","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","config","serviceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","initializeIcons","ReactDOM","render","Fabric","document","getElementById","URL","process","href","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d8384ac1.chunk.js","sourcesContent":["function getServerUrl() {\r\n  return 'https://fintrack-image-occpy2fuaa-an.a.run.app';\r\n  //return 'http://localhost'\r\n}\r\n\r\nfunction isReachable() {\r\n  return fetch(this.getServerUrl(), { method: 'HEAD', mode: 'no-cors' })\r\n    .then((resp) => {\r\n      return true;\r\n    })\r\n    .catch((err) => {\r\n      return false;\r\n    });\r\n}\r\n\r\nfunction login(username, password) {\r\n  var url = this.getServerUrl() + '/api/user/login';\r\n\r\n  return fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ UserName: username, Password: password })\r\n  }).then((response) => {\r\n    if (response.ok) {\r\n      return response.json().then((data) => {\r\n        return {\r\n          success: true,\r\n          token: data.token\r\n        };\r\n      });\r\n    }\r\n    else {\r\n      return {\r\n        success: false\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nfunction register(username, password) {\r\n  var url = this.getServerUrl() + '/api/user/register';\r\n\r\n  return fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ UserName: username, Password: password })\r\n  }).then((response) => {\r\n    if (response.ok) {\r\n      return {\r\n        success: true\r\n      };\r\n    }\r\n    else {\r\n      return {\r\n        success: false\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  getServerUrl,\r\n  isReachable,\r\n  login,\r\n  register\r\n};\r\n","function getToken() {\r\n  return localStorage.getItem('authToken');\r\n}\r\n\r\nfunction saveToken(token) {\r\n  localStorage.setItem('authToken', token);\r\n}\r\n\r\nexport default {\r\n  getToken,\r\n  saveToken\r\n};","import React, { Component } from 'react';\r\nimport { PrimaryButton, MessageBar, MessageBarType } from 'office-ui-fabric-react';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\r\nimport { Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport authConnector from '../utils/authConnector.js';\r\nimport authUtils from '../utils/authUtils.js';\r\n\r\nclass AuthSceen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.showLogin = this.showLogin.bind(this);\r\n    this.showRegister = this.showRegister.bind(this);\r\n    this.handleInputChange = this.handleInputChange.bind(this);\r\n    this.handleLogin = this.handleLogin.bind(this);\r\n    this.handleRegister = this.handleRegister.bind(this);\r\n    this.verifyPassword = this.verifyPassword.bind(this);\r\n\r\n    this.loggedIn = this.props.completionCallback;\r\n    this.state = {\r\n      showLogin: true,\r\n      showRegister: false,\r\n      showSpinner: false,\r\n      regSuccess: false,\r\n      regFailed: false,\r\n      loginFailed: false,\r\n      LoginUserName: '',\r\n      LoginPassword: '',\r\n      RegUserName: '',\r\n      RegPassword: '',\r\n      RegPasswordVerify: ''\r\n    }\r\n  }\r\n\r\n  showLogin() {\r\n    this.setState({\r\n      showLogin: true,\r\n      showRegister: false,\r\n      regSuccess: false,\r\n      regFailed: false,\r\n      loginFailed: false\r\n    });\r\n  }\r\n\r\n  showRegister() {\r\n    this.setState({\r\n      showLogin: false,\r\n      showRegister: true,\r\n      regSuccess: false,\r\n      regFailed: false,\r\n      loginFailed: false\r\n    });\r\n  }\r\n\r\n  handleInputChange(event) {\r\n    const value = event.target.value;\r\n    const name = event.target.name;\r\n\r\n    this.setState({\r\n      [name]: value\r\n    });\r\n  }\r\n\r\n  verifyPassword(value) {\r\n    return value === this.state.RegPassword ? '' : 'Passwords do not match';\r\n  }\r\n\r\n  handleLogin(event) {\r\n    event.preventDefault();\r\n\r\n    this.setState({\r\n      showSpinner: true\r\n    });\r\n    authConnector.login(this.state.LoginUserName, this.state.LoginPassword).then((result) => {\r\n      this.setState({\r\n        showSpinner: false\r\n      });\r\n      if (result.success) {\r\n        authUtils.saveToken(result.token);\r\n        this.setState({\r\n          regSuccess: false,\r\n          loginFailed: false\r\n        });\r\n        this.loggedIn();\r\n      }\r\n      else {\r\n        this.setState({\r\n          regSuccess: false,\r\n          loginFailed: true\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  handleRegister(event) {\r\n    event.preventDefault();\r\n\r\n    if (this.state.RegPassword !== this.state.RegPasswordVerify) {\r\n      return;\r\n    }\r\n\r\n    this.setState({\r\n      showSpinner: true\r\n    });\r\n    authConnector.register(this.state.LoginUserName, this.state.LoginPassword).then((result) => {\r\n      this.setState({\r\n        showSpinner: false\r\n      });\r\n      if (result.success) {\r\n        this.setState({\r\n          showLogin: true,\r\n          showRegister: false,\r\n          regSuccess: true,\r\n          regFailed: false\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          regFailed: true\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {\r\n          this.state.showLogin &&\r\n          <form onSubmit={this.handleLogin}>\r\n            <Stack tokens={{ childrenGap: 10 }} horizontalAlign=\"center\">\r\n              {\r\n                this.state.regSuccess &&\r\n                <MessageBar messageBarType={MessageBarType.success} isMultiline={false}>\r\n                  Registration successful\r\n                </MessageBar>\r\n              }\r\n              {\r\n                this.state.loginFailed &&\r\n                <MessageBar messageBarType={MessageBarType.error} isMultiline={false}>\r\n                  The username and password do not match\r\n                </MessageBar>\r\n              }\r\n              <TextField label=\"User name\" name=\"LoginUserName\" value={this.state.LoginUserName} onChange={this.handleInputChange} required />\r\n              <TextField label=\"Password\" name=\"LoginPassword\" value={this.state.LoginPassword} onChange={this.handleInputChange} type=\"password\" required />\r\n              <Stack horizontal tokens={{ childrenGap: 10 }} verticalAlign=\"center\">\r\n                <PrimaryButton text=\"Login\" type=\"submit\" />\r\n                { this.state.showSpinner && <Spinner size={SpinnerSize.small} /> }\r\n              </Stack>\r\n              <Link onClick={this.showRegister}>Click here to register</Link>\r\n            </Stack>\r\n          </form>\r\n        }\r\n        {\r\n          this.state.showRegister &&\r\n          <form onSubmit={this.handleRegister}>\r\n            <Stack tokens={{ childrenGap: 10 }} horizontalAlign=\"center\">\r\n              {\r\n                this.state.regFailed &&\r\n                <MessageBar messageBarType={MessageBarType.error} isMultiline={false}>\r\n                  The username and password do not match.\r\n                </MessageBar>\r\n              }\r\n              <TextField label=\"User name\" name=\"RegUserName\" value={this.state.RegUserName} onChange={this.handleInputChange} required />\r\n              <TextField label=\"Password\" name=\"RegPassword\" type=\"password\" value={this.state.RegPassword} onChange={this.handleInputChange} required />\r\n              <TextField label=\"Verify password\" name=\"RegPasswordVerify\" type=\"password\" value={this.state.RegPasswordVerify} onChange={this.handleInputChange} onGetErrorMessage={this.verifyPassword} required />\r\n              <Stack horizontal tokens={{ childrenGap: 10 }} verticalAlign=\"center\">\r\n                <PrimaryButton text=\"Register\" type=\"submit\" />\r\n                { this.state.showSpinner && <Spinner size={SpinnerSize.small} /> }\r\n              </Stack>\r\n              <Link onClick={this.showLogin}>Return to login</Link>\r\n            </Stack>\r\n          </form>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AuthSceen;","function getServerUrl() {\r\n  return 'https://fintrack-image-occpy2fuaa-an.a.run.app';\r\n  //return 'http://localhost'\r\n}\r\n\r\nfunction listLedgers(token) {\r\n  var getUrl = this.getServerUrl() + '/api/ledger/list';\r\n\r\n  var authHeader = new Headers({\r\n    'Authorization': 'Bearer ' + token\r\n  });\r\n\r\n  return fetch(getUrl, { headers: authHeader }).then((response) => {\r\n    if (response.ok) {\r\n      return response.json().then((data) => {\r\n        return {\r\n          success: true,\r\n          data: data\r\n        };\r\n      });\r\n    }\r\n    else {\r\n      if (response.status === 404) {\r\n        return {\r\n          success: false,\r\n          status: 'Not found'\r\n        };\r\n      }\r\n      else if (response.status === 401 || response.status === 403) {\r\n        return {\r\n          success: false,\r\n          status: 'Unauthorized'\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        status: 'Error',\r\n        data: []\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nfunction getLedger(token, year, month) {\r\n  var getUrl = this.getServerUrl() + '/api/ledger/get?year=' + year + '&month=' + month;\r\n  var authHeader = new Headers({\r\n    'Authorization': 'Bearer ' + token\r\n  });\r\n\r\n  return fetch(getUrl, { headers: authHeader }).then((response) => {\r\n    if (response.ok) {\r\n      return response.json().then((data) => {\r\n        return {\r\n          success: true,\r\n          data: data\r\n        };\r\n      });\r\n    }\r\n    else {\r\n      if (response.status === 401 || response.status === 403) {\r\n        return {\r\n          success: false,\r\n          status: 'Unauthorized'\r\n        };\r\n      }\r\n      else if (response.status === 404) {\r\n        return {\r\n          success: false,\r\n          status: 'Not found'\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        status: 'Error',\r\n        data: {\r\n          \"Id\": \"\",\r\n          \"Owner\": \"\",\r\n          \"Type\": \"\",\r\n          \"Month\": \"\",\r\n          \"Year\": \"\",\r\n          \"Debits\": [\r\n          ],\r\n          \"DebitTotal\": \"\",\r\n          \"Credits\": [\r\n          ],\r\n          \"CreditTotal\": \"\"\r\n        }\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nfunction addLedger(token, ledger) {\r\n  var addUrl = this.getServerUrl() + '/api/ledger/add';\r\n  var authHeader = new Headers({\r\n    'Authorization': 'Bearer ' + token,\r\n    'Content-Type': 'application/json'\r\n  });\r\n\r\n  return fetch(addUrl, {\r\n    method: 'POST',\r\n    headers: authHeader,\r\n    body: JSON.stringify(ledger)\r\n  })\r\n  .then((response) => {\r\n    if (response.ok) {\r\n      return {\r\n        success: true\r\n      };\r\n    }\r\n    else {\r\n      if (response.status === 401 || response.status === 403) {\r\n        return {\r\n          success: false,\r\n          status: 'Unauthorized'\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        status: 'Error'\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nfunction updateLedger(token, ledger) {\r\n  var updateUrl = this.getServerUrl() + '/api/ledger/update?id=' + ledger.Id;\r\n  var authHeader = new Headers({\r\n    'Authorization': 'Bearer ' + token,\r\n    'Content-Type': 'application/json'\r\n  });\r\n\r\n  return fetch(updateUrl, {\r\n    method: 'PUT',\r\n    headers: authHeader,\r\n    body: JSON.stringify(ledger)\r\n  })\r\n  .then((response) => {\r\n    if (response.ok) {\r\n      return {\r\n        success: true\r\n      };\r\n    }\r\n    else {\r\n      if (response.status === 401 || response.status === 403) {\r\n        return {\r\n          success: false,\r\n          status: 'Unauthorized'\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        status: 'Error'\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nfunction deleteLedger(token, ledger) {\r\n  var deleteUrl = this.getServerUrl() + '/api/ledger/delete?id=' + ledger.Id;\r\n  var authHeader = new Headers({\r\n    'Authorization': 'Bearer ' + token,\r\n    'Content-Type': 'application/json'\r\n  });\r\n\r\n  return fetch(deleteUrl, {\r\n    method: 'DELETE',\r\n    headers: authHeader\r\n  })\r\n  .then((response) => {\r\n    if (response.ok) {\r\n      return {\r\n        success: true\r\n      };\r\n    }\r\n    else {\r\n      if (response.status === 401 || response.status === 403) {\r\n        return {\r\n          success: false,\r\n          status: 'Unauthorized'\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        status: 'Error'\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  getServerUrl,\r\n  listLedgers,\r\n  getLedger,\r\n  addLedger,\r\n  updateLedger,\r\n  deleteLedger\r\n};\r\n","import authUtils from './../utils/authUtils.js';\r\nimport authConnector from './../utils/authConnector.js';\r\nimport ledgerConnector from './../utils/ledgerConnector.js';\r\n\r\n// IndexedDB setup\r\nvar db;\r\nvar dbRequest = window.indexedDB.open('FinTrackDB', 1);\r\ndbRequest.onsuccess = (event) => {\r\n  db = event.target.result;\r\n};\r\ndbRequest.onerror = (event) => {\r\n  console.log(\"Unable to use IndexedDB\");\r\n};\r\ndbRequest.onupgradeneeded = (event) => {\r\n  db = event.target.result;\r\n\r\n  var objectStore = db.createObjectStore('ledgers', { autoIncrement : true });\r\n  objectStore.createIndex('Id', 'Id', { unique: false });\r\n  objectStore.createIndex('Year', 'Year', { unique: false });\r\n  objectStore.createIndex('Month', 'Month', { unique: false });\r\n};\r\n\r\n// Online offline handlers\r\nvar serverUrl = ledgerConnector.getServerUrl();\r\nvar isOnline = true;\r\nwindow.addEventListener('online', handleConnection);\r\nwindow.addEventListener('offline', handleConnection);\r\n\r\nfunction handleConnection() {\r\n  if (navigator.onLine) {\r\n    authConnector.isReachable(serverUrl).then((online) => {\r\n      if (online) {\r\n        console.log('Client online');\r\n        isOnline = true;\r\n      } else {\r\n        console.log('No connectivity');\r\n        isOnline = false;\r\n      }\r\n    });\r\n  } else {\r\n    console.log('Client offline');\r\n    isOnline = false;\r\n  }\r\n}\r\n\r\n// Worker core\r\nvar token = authUtils.getToken();\r\nfunction onmessage(e) {\r\n  var objectStore = db.transaction(['ledgers'], 'readwrite').objectStore('ledgers');\r\n  objectStore.add(e.data);\r\n}\r\n\r\nsetInterval(sync, 10000);\r\n\r\nfunction sync() {\r\n  if (isOnline) {\r\n    var objectStore = db.transaction('ledgers').objectStore('ledgers');\r\n    objectStore.getCursor().onsuccess = (e) => {\r\n      var cursor = e.target.result;\r\n      if (cursor) {\r\n        console.log('Syncing entry ' + cursor.value.key);\r\n        syncLedger(cursor.value).then((result) => {\r\n          if (result) {\r\n            console.log('Entry ' + cursor.value.key + ' synced');\r\n            console.log('Deleting entry ' + cursor.value.key);\r\n            db.transaction('ledgers', 'readwrite').objectStore('ledgers').delete(cursor.value.key).onsuccess = () => true;\r\n          }\r\n        }).then((result) => {\r\n          console.log('Delete complete');\r\n          cursor.continue();\r\n        }).catch(() => {\r\n          console.log('Syncing failed for entry ' + cursor.value.key);\r\n          cursor.continue();\r\n        });\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nfunction syncLedger(ledger) {\r\n  ledgerConnector.getLedger(token, ledger.Year, ledger.Month).then((result) => {\r\n    if (result.success) {\r\n      const serverUpd = Date.parse(result.data.UpdatedAt);\r\n      const localUpd = Date.parse(ledger.UpdatedAt);\r\n      if (localUpd > serverUpd) {\r\n        return updateLedger(ledger).then((result) => {\r\n          return result;\r\n        });\r\n      }\r\n      else {\r\n        return true;\r\n      }\r\n    }\r\n    else {\r\n      if (result.status === 'Unauthorized') {\r\n        postMessage('Unauthorized');\r\n        return false;\r\n      }\r\n      else if (result.status === 'Not found') {\r\n        return addLedger(ledger).then((result) => {\r\n          return result;\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction updateLedger(ledger) {\r\n  ledgerConnector.updateLedger(token, ledger).then((result) => {\r\n    if (result.success) {\r\n      return true;\r\n    }\r\n    else {\r\n      if (result.status === 'Unauthorized') {\r\n        postMessage('Unauthorized');\r\n      }\r\n      return false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction addLedger(ledger) {\r\n  ledgerConnector.addLedger(token, ledger).then((result) => {\r\n    if (result.success) {\r\n      return true;\r\n    }\r\n    else {\r\n      if (result.status === 'Unauthorized') {\r\n        postMessage('Unauthorized');\r\n      }\r\n      return false;\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  onmessage\r\n};\r\n","import React, { Component } from 'react';\r\nimport { CommandBar } from 'office-ui-fabric-react/lib/CommandBar';\r\nimport { Text } from 'office-ui-fabric-react/lib/Text';\r\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { List } from 'office-ui-fabric-react/lib/List';\r\nimport { Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\r\nimport ledgerConnector from './../utils/ledgerConnector.js';\r\nimport authUtils from './../utils/authUtils.js';\r\n\r\nclass LedgerList extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.updateLedgerList = this.updateLedgerList.bind(this);\r\n    this.addLedger = this.addLedger.bind(this);\r\n    this.showFixed = this.showFixed.bind(this);\r\n    this.onChangeHandler = this.onChangeHandler.bind(this);\r\n    this.renderCell = this.renderCell.bind(this);\r\n\r\n    this.showingFixed = false;\r\n    this.selectionHandler = this.props.selectHandler;\r\n    this.loginHandler = this.props.loginHandler;\r\n    this.months = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\n    this.ledgers = [];\r\n    this.commandItems = [\r\n      {\r\n        key: 'new',\r\n        text: 'New item',\r\n        iconProps: { iconName: 'Add' },\r\n        onClick: this.addLedger\r\n      }\r\n    ];\r\n    this.farItems = [\r\n      {\r\n        key: 'fixed',\r\n        text: 'Fixed',\r\n        iconProps: { iconName: 'Calendar' },\r\n        onClick: this.showFixed\r\n      },\r\n      {\r\n        key: 'refresh',\r\n        text: 'Refresh',\r\n        ariaLabel: 'Refresh',\r\n        iconOnly: true,\r\n        iconProps: { iconName: 'Refresh' },\r\n        onClick: this.updateLedgerList\r\n      }\r\n    ];\r\n    this.state = {\r\n      dropdownOptions: [],\r\n      displayedLedgers: [],\r\n      showSpinner: false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.updateLedgerList();\r\n  }\r\n\r\n  configureDropdown() {\r\n    let years = [];\r\n    for (let i = 0; i < this.ledgers.length; i++) {\r\n      if (years.indexOf(this.ledgers[i].Year) === -1) {\r\n        years.push(parseInt(this.ledgers[i].Year));\r\n      }\r\n    }\r\n    years.sort((a, b) => b - a); // Descending\r\n\r\n    let options = [];\r\n    options.push({ key: '', text: '' });\r\n    for (let i = 0; i < years.length; i++) {\r\n      options.push({ key: years[i], text: years[i] });\r\n    }\r\n    this.setState({\r\n      dropdownOptions: options\r\n    });\r\n  }\r\n\r\n  updateLedgerList() {\r\n    this.setState({\r\n      showSpinner: true\r\n    });\r\n    ledgerConnector.listLedgers(authUtils.getToken()).then((result) => {\r\n      this.setState({\r\n        showSpinner: false\r\n      });\r\n      if (result.success) {\r\n        this.ledgers = result.data.filter((item) => {\r\n          return item.Type === 'regular';\r\n        });\r\n        this.ledgers.sort(this.sortLedgers);\r\n        this.setState({\r\n          displayedLedgers: this.ledgers\r\n        });\r\n        this.configureDropdown();\r\n      }\r\n      else {\r\n        if (result.status === 'Unauthorized') {\r\n          this.loginHandler();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  showFixed() {\r\n    this.selectionHandler({\r\n      target: {\r\n        dataset: {\r\n          year: 0,\r\n          month: 0\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  filterByYear(year) {\r\n    return this.ledgers.filter((item) => {\r\n      return item.Year == year;\r\n    });\r\n  }\r\n\r\n  sortLedgers(a, b) {\r\n    if (a.Year !== b.Year) {\r\n      return b.Year - a.Year;\r\n    }\r\n    return b.Month - a.Month;\r\n  }\r\n\r\n  addLedger() {\r\n    let date = new Date();\r\n    let latestYear = date.getFullYear();\r\n    let latestMonth = date.getMonth() + 1;\r\n\r\n    if (this.ledgers.length > 0) {\r\n      latestYear = parseInt(this.ledgers[0].Year);\r\n      latestMonth = parseInt(this.ledgers[0].Month);\r\n\r\n      latestMonth++;\r\n      if (latestMonth === 13) {\r\n        latestYear++;\r\n        latestMonth = 1;\r\n      }\r\n    }\r\n\r\n    this.selectionHandler({\r\n      target: {\r\n        dataset: {\r\n          year: latestYear,\r\n          month: latestMonth\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  onChangeHandler(event, item) {\r\n    if (item.value === '') {\r\n      this.setState({\r\n        displayedLedgers: this.ledgers\r\n      });\r\n    }\r\n    else {\r\n      this.setState({\r\n        displayedLedgers: this.filterByYear(item.value).sort(this.sortLedgers)\r\n      });\r\n    }\r\n  }\r\n\r\n  renderCell(item, index) {\r\n    return (\r\n      <div className=\"list-item\" onClick={this.selectionHandler} data-year={item.Year} data-month={item.Month}>\r\n        <Text data-year={item.Year} data-month={item.Month}>{`${item.Year} ${this.months[item.Month]}`}</Text>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div data-is-scrollable=\"true\">\r\n        <Stack>\r\n          <Dropdown placeholder=\"Filter by year\" options={this.state.dropdownOptions} onChange={this.onChangeHandler} />\r\n          <CommandBar\r\n            items={this.commandItems}\r\n            farItems={this.farItems}\r\n            ariaLabel=\"\"\r\n          />\r\n          { this.state.showSpinner && <Spinner size={SpinnerSize.medium} /> }\r\n          <List items={this.state.displayedLedgers} onRenderCell={this.renderCell} />\r\n        </Stack>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LedgerList;\r\n","import React, { Component } from 'react';\r\nimport { MessageBar, MessageBarType, DefaultPalette } from 'office-ui-fabric-react';\r\nimport { CommandBar } from 'office-ui-fabric-react/lib/CommandBar';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { ShimmeredDetailsList } from 'office-ui-fabric-react/lib/ShimmeredDetailsList';\r\nimport { SelectionMode, DetailsListLayoutMode } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport ledgerConnector from '../utils/ledgerConnector.js';\r\nimport authUtils from './../utils/authUtils.js';\r\n\r\nclass LedgerDetails extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.save = this.save.bind(this);\r\n    this.addItem = this.addItem.bind(this);\r\n    this.handleTabClick = this.handleTabClick.bind(this);\r\n    this.renderItemColumn = this.renderItemColumn.bind(this);\r\n    this.onChangeHandler = this.onChangeHandler.bind(this);\r\n    this.populateFixedItems = this.populateFixedItems.bind(this);\r\n\r\n    this.loginHandler = this.props.loginHandler;\r\n    this.backToList = this.props.returnHandler;\r\n    this.parameters = {\r\n      year: this.props.selection.year,\r\n      month: this.props.selection.month,\r\n      type: this.props.selection.year === 0 ? 'fixed' : 'regular'\r\n    };\r\n    this.newLedger = false;\r\n    this.displayprops = {\r\n      columns: [\r\n        {\r\n          key: 'item',\r\n          name: 'Item',\r\n          fieldName: 'Label',\r\n          isPadded: true\r\n        },\r\n        {\r\n          key: 'amount',\r\n          name: 'Amount',\r\n          fieldName: 'Amount',\r\n          isPadded: true\r\n        },\r\n      ],\r\n      stackItemStyles: {\r\n        root: {\r\n          alignItems: 'center',\r\n          justifyContent: 'right',\r\n          display: 'grid'\r\n        }\r\n      }\r\n    }\r\n    this.commandItems = [\r\n      {\r\n        key: 'back',\r\n        text: 'Back',\r\n        ariaLabel: 'Back',\r\n        iconOnly: true,\r\n        iconProps: { iconName: 'Back' },\r\n        onClick: this.backToList\r\n      },\r\n      {\r\n        key: 'new',\r\n        text: 'New item',\r\n        iconProps: { iconName: 'Add' },\r\n        onClick: this.addItem\r\n      }\r\n    ];\r\n    this.farItems = [\r\n      {\r\n        key: 'save',\r\n        text: 'Save',\r\n        ariaLabel: 'Save',\r\n        iconOnly: true,\r\n        iconProps: { iconName: 'CheckMark' },\r\n        onClick: this.save\r\n      }\r\n    ];\r\n    this.state = {\r\n      ledger: {\r\n        Type: this.parameters.type,\r\n        Month: this.parameters.month,\r\n        Year: this.parameters.year,\r\n        Debits: [],\r\n        DebitTotal: \"\",\r\n        Credits: [],\r\n        CreditTotal: \"\"\r\n      },\r\n      selectedTab: 'Debits',\r\n      saveSuccess: false,\r\n      saveFailed: false,\r\n      dataLoaded: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getLedgerDetails();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.selection.Year !== prevProps.selection.Year &&\r\n        this.props.selection.Month !== prevProps.selection.Month) {\r\n      this.getLedgerDetails();\r\n    }\r\n  }\r\n\r\n  getLedgerDetails() {\r\n    console.log(`Loading ${this.parameters.year}/${this.parameters.month}`);\r\n\r\n    ledgerConnector.getLedger(authUtils.getToken(), this.parameters.year, this.parameters.month).then((result) => {\r\n      this.setState({\r\n        dataLoaded: true\r\n      });\r\n      if (result.success) {\r\n        this.setState({\r\n          ledger: result.data\r\n        });\r\n      }\r\n      else {\r\n        if (result.status === 'Not found') {\r\n          console.log('No data found. New ledger will be created');\r\n          this.newLedger = true;\r\n          if (this.state.ledger.type === 'regular') {\r\n            this.populateFixedItems();\r\n          }\r\n        }\r\n        else if (result.status === 'Unauthorized') {\r\n          this.loginHandler();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  populateFixedItems() {\r\n    console.log(`Loading fixed items`);\r\n    this.setState({\r\n      dataLoaded: false\r\n    });\r\n\r\n    ledgerConnector.getLedger(authUtils.getToken(), 0, 0).then((result) => {\r\n      this.setState({\r\n        dataLoaded: true\r\n      });\r\n      if (result.success) {\r\n        this.setState(prevState => ({\r\n          ledger: {\r\n            ...prevState.ledger,\r\n            Debits: prevState.ledger.Debits.concat({\r\n              Label: 'Fixed expenses',\r\n              Amount: result.data.DebitTotal\r\n            }),\r\n            Credits: prevState.ledger.Credits.concat({\r\n              Label: 'Fixed income',\r\n              Amount: result.data.CreditTotal\r\n            }),\r\n            DebitTotal: result.data.DebitTotal,\r\n            CreditTotal: result.data.CreditTotal\r\n          }\r\n        }));\r\n      }\r\n      else {\r\n        if (result.status === 'Unauthorized') {\r\n          this.loginHandler();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  addItem() {\r\n    console.log(`Adding new item to ${this.state.selectedTab}`);\r\n\r\n    this.setState(prevState => ({\r\n      ledger: {\r\n        ...prevState.ledger,\r\n        [this.state.selectedTab]: prevState.ledger[this.state.selectedTab].concat({\r\n          Label: '',\r\n          Amount: ''\r\n        })\r\n      }\r\n    }));\r\n  }\r\n\r\n  save() {\r\n    this.setState({\r\n      saveSuccess: false,\r\n      saveFailed: false\r\n    });\r\n    if (this.newLedger) {\r\n      ledgerConnector.addLedger(authUtils.getToken(), this.state.ledger).then((result) => {\r\n        if (result.success) {\r\n          this.setState({\r\n            saveSuccess: true\r\n          });\r\n        }\r\n        else {\r\n          this.setState({\r\n            saveFailed: true\r\n          });\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      ledgerConnector.updateLedger(authUtils.getToken(), this.state.ledger).then((result) => {\r\n        if (result.success) {\r\n          this.setState({\r\n            saveSuccess: true\r\n          });\r\n        }\r\n        else {\r\n          this.setState({\r\n            saveFailed: true\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  calculateTotal(total, current) {\r\n    if (current.Amount) {\r\n      return total + parseInt(current.Amount);\r\n    }\r\n    return total;\r\n  }\r\n\r\n  handleTabClick(item) {\r\n    this.setState({\r\n      selectedTab: item.props.itemKey\r\n    });\r\n  }\r\n\r\n  onChangeHandler(event) {\r\n    const value = event.target.value;\r\n    const name = event.target.name;\r\n    const index = parseInt(event.target.dataset.index);\r\n    console.log(`Updating ${name} of item ${index} of ${this.state.selectedTab}`);\r\n\r\n    this.setState(prevState => ({\r\n      ledger: {\r\n        ...prevState.ledger,\r\n        [this.state.selectedTab]: prevState.ledger[this.state.selectedTab].map((el, i) => i === index ? {\r\n          ...el, [name]: value\r\n        } : el)\r\n      }\r\n    }), () => {\r\n      if (this.state.selectedTab === 'Debits') {\r\n        this.setState(prevState => ({\r\n          ledger: {\r\n            ...prevState.ledger,\r\n            DebitTotal: prevState.ledger.Debits.reduce(this.calculateTotal, 0)\r\n          }\r\n        }));\r\n      }\r\n      else {\r\n        this.setState(prevState => ({\r\n          ledger: {\r\n            ...prevState.ledger,\r\n            CreditTotal: prevState.ledger.Credits.reduce(this.calculateTotal, 0)\r\n          }\r\n        }));\r\n      }\r\n    });\r\n  }\r\n\r\n  renderItemColumn(item, index, column) {\r\n    switch (column.key) {\r\n      case 'item':\r\n        return <TextField ariaLabel=\"Item\" name=\"Label\" data-index={index} value={this.state.ledger[this.state.selectedTab][index].Label} onChange={this.onChangeHandler} />;\r\n\r\n      case 'amount':\r\n        return <TextField ariaLabel=\"Amount\" name=\"Amount\" type=\"number\" data-index={index} value={this.state.ledger[this.state.selectedTab][index].Amount} onChange={this.onChangeHandler} />;\r\n\r\n      default:\r\n        return;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {\r\n          this.state.saveSuccess &&\r\n          <MessageBar messageBarType={MessageBarType.success} isMultiline={false}>\r\n            Saved\r\n          </MessageBar>\r\n        }\r\n        {\r\n          this.state.saveFailed &&\r\n          <MessageBar messageBarType={MessageBarType.error} isMultiline={false}>\r\n            Could not save. Please try again.\r\n          </MessageBar>\r\n        }\r\n        <CommandBar\r\n          items={this.commandItems}\r\n          farItems={this.farItems}\r\n          ariaLabel=\"\"\r\n        />\r\n        <Pivot\r\n            selectedKey={this.state.selectedTab}\r\n            onLinkClick={this.handleTabClick}\r\n            styles={{ link: {width:\"50%\"}, linkIsSelected: {width:\"50%\"} }}>\r\n          <PivotItem headerText=\"Expenses\" itemKey=\"Debits\">\r\n            <div data-is-scrollable=\"true\">\r\n              <ShimmeredDetailsList\r\n                items={this.state.ledger.Debits}\r\n                columns={this.displayprops.columns}\r\n                selectionMode={SelectionMode.none}\r\n                layoutMode={DetailsListLayoutMode.justified}\r\n                isHeaderVisible={true}\r\n                enableShimmer={!this.state.dataLoaded}\r\n                onRenderItemColumn={this.renderItemColumn}\r\n              />\r\n              <Stack horizontal horizontalAlign=\"end\" tokens={{ childrenGap: 10, padding: 32 }}>\r\n              <Stack.Item grow={5} styles={this.displayprops.stackItemStyles}>\r\n                  Total\r\n                </Stack.Item>\r\n                <Stack.Item grow styles={this.displayprops.stackItemStyles}>\r\n                  {this.state.ledger.DebitTotal}\r\n                </Stack.Item>\r\n              </Stack>\r\n            </div>\r\n          </PivotItem>\r\n          <PivotItem headerText=\"Income\" itemKey=\"Credits\">\r\n            <div data-is-scrollable=\"true\">\r\n              <ShimmeredDetailsList\r\n                items={this.state.ledger.Credits}\r\n                columns={this.displayprops.columns}\r\n                selectionMode={SelectionMode.none}\r\n                layoutMode={DetailsListLayoutMode.justified}\r\n                isHeaderVisible={true}\r\n                enableShimmer={!this.state.dataLoaded}\r\n                onRenderItemColumn={this.renderItemColumn}\r\n              />\r\n              <Stack horizontal horizontalAlign=\"end\" tokens={{ childrenGap: 10, padding: 32 }}>\r\n                <Stack.Item grow={5} styles={this.displayprops.stackItemStyles}>\r\n                  Total\r\n                </Stack.Item>\r\n                <Stack.Item grow styles={this.displayprops.stackItemStyles}>\r\n                  {this.state.ledger.CreditTotal}\r\n                </Stack.Item>\r\n              </Stack>\r\n            </div>\r\n          </PivotItem>\r\n        </Pivot>\r\n        <Stack horizontal horizontalAlign=\"end\" tokens={{ childrenGap: 10, padding: 32 }}>\r\n          <Stack.Item grow={5} styles={this.displayprops.stackItemStyles}>\r\n            <b>Net</b>\r\n          </Stack.Item>\r\n          <Stack.Item grow styles={this.displayprops.stackItemStyles}>\r\n            <b>{this.state.ledger.CreditTotal - this.state.ledger.DebitTotal}</b>\r\n          </Stack.Item>\r\n        </Stack>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LedgerDetails;\r\n","import React, { Component } from 'react';\nimport { Text } from 'office-ui-fabric-react/lib/Text';\nimport { CSSTransition } from 'react-transition-group';\nimport AuthScreen from './components/AuthScreen.js';\nimport LedgerList from './components/LedgerList.js';\nimport LedgerDetails from './components/LedgerDetails.js';\nimport './css/App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.loginHandler = this.loginHandler.bind(this);\n    this.selectionHandler = this.selectionHandler.bind(this);\n    this.backToList = this.backToList.bind(this);\n    this.loggedIn = this.loggedIn.bind(this);\n\n    this.state = {\n      title: 'Ledgers',\n      showLedgerList: true,\n      showLedger: false,\n      showLogin: false,\n      selectedLedger: {\n        year: '',\n        month: ''\n      }\n    };\n    this.months = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n  }\n\n  loginHandler() {\n    this.origin = this.state.title;\n    this.setState({\n      title: 'Sign in',\n      showLedgerList: false,\n      showLedger: false,\n      showLogin: true\n    });\n  }\n\n  loggedIn() {\n    if (this.origin === 'Ledgers') {\n      this.setState({\n        title: 'Ledgers',\n        showLedgerList: true,\n        showLedger: false,\n        showLogin: false\n      });\n    }\n    else {\n      this.setState({\n        title: this.origin,\n        showLedgerList: false,\n        showLedger: true,\n        showLogin: false\n      });\n    }\n  }\n\n  selectionHandler(event) {\n    let year = parseInt(event.target.dataset.year);\n    let month = parseInt(event.target.dataset.month);\n    let title = `${year} ${this.months[month]}`;\n\n    if (year === 0 && month === 0) {\n      title = 'Fixed items';\n    }\n\n    this.setState({\n      title: title,\n      selectedLedger: {\n        year: year,\n        month: month\n      },\n      showLedgerList: false,\n      showLedger: true,\n      showLogin: false\n    });\n  }\n\n  backToList() {\n    this.setState({\n      title: 'Ledgers',\n      showLedgerList: true,\n      showLedger: false,\n      showLogin: false\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"ms-Grid\" dir=\"ltr\">\n        <div className=\"ms-Grid-row header\">\n          <div className=\"ms-Grid-col ms-sm12 align-center\">\n            <Text variant={'large'}>{this.state.title}</Text>\n          </div>\n        </div>\n        <CSSTransition in={this.state.showLedgerList} timeout={200} classNames=\"ledgerList\" mountOnEnter unmountOnExit>\n          <LedgerList selectHandler={this.selectionHandler} loginHandler={this.loginHandler} />\n        </CSSTransition>\n        <CSSTransition in={this.state.showLedger} timeout={200} classNames=\"ledgerDetails\" mountOnEnter unmountOnExit>\n          <LedgerDetails selection={this.state.selectedLedger} loginHandler={this.loginHandler} returnHandler={this.backToList} />\n        </CSSTransition>\n        <CSSTransition in={this.state.showLogin} timeout={200} classNames=\"authScreen\" mountOnEnter unmountOnExit>\n          <AuthScreen completionCallback={this.loggedIn} />\n        </CSSTransition>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import syncWorker from './syncWorker';\r\n\r\nvar cacheName = 'fintrackCache-v1';\r\nvar appShellFiles = [\r\n  // List all static files\r\n  ''\r\n];\r\n\r\nsyncWorker.onmessage = (e) => {\r\n  if (e.data == 'Unauthorized') {\r\n\r\n  }\r\n};\r\n\r\nwindow.addEventListener('install', (e) => {\r\n  console.log('[Service worker] Install');\r\n  e.waitUntil(\r\n    caches.open(cacheName).then((cache) => {\r\n      console.log('[Service worker] Caching app shell');\r\n      return cache.addAll(appShellFiles);\r\n    })\r\n  );\r\n});\r\n\r\nwindow.addEventListener('fetch', (e) => {\r\n  e.respondWith(\r\n    // Try loading through network first\r\n    fetch(e.request).then((response) => {\r\n      return caches.open(cacheName).then((cache) => {\r\n        console.log('[Service Worker] Caching new resource: '+ e.request.url);\r\n        cache.put(e.request, response.clone());\r\n        return response;\r\n      });\r\n    }).catch(() => {\r\n      // Search the cache if it's a GET\r\n      if (e.request.method == 'GET') {\r\n        caches.match(e.request).then((r) => {\r\n          return r;\r\n        }).catch(() => {\r\n          return new Response(JSON.stringify({ error: 'No network connection' }));\r\n        });\r\n      }\r\n      // Save the data to be synced later\r\n      else {\r\n        e.request.json().then((data) => {\r\n          syncWorker.postMessage(data);\r\n        });\r\n      }\r\n    })\r\n  );\r\n});\r\n\r\nwindow.addEventListener('activate', (e) => {\r\n  e.waitUntil(\r\n    caches.keys().then((keyList) => {\r\n      return Promise.all(keyList.map((key) => {\r\n        if(key !== cacheName) {\r\n          return caches.delete(key);\r\n        }\r\n      }));\r\n    })\r\n  );\r\n});\r\n","import * as serviceworker from './workers/service-worker';\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/workers/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Fabric } from 'office-ui-fabric-react/lib/Fabric';\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\nimport './css/index.css';\nimport '../node_modules/office-ui-fabric-react/dist/css/fabric.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\ninitializeIcons();\n\nReactDOM.render(\n  <Fabric>\n    <App />\n  </Fabric>\n  , document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}